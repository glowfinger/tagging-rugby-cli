{
  "project": "tagging-rugby-cli",
  "branchName": "ralph/remove-migration-002",
  "description": "Remove migration 002, canonicalise migration 001 with FK constraint, delete orphaned insert_note_video.sql",
  "userStories": [
    {
      "id": "US-001",
      "title": "Remove migration 002 file",
      "description": "As a developer, I want migration 002 deleted so the migration system contains only a single authoritative schema file.",
      "acceptanceCriteria": [
        "db/sql/migrations/002_migrate_note_videos.sql is deleted",
        "Grep confirms no file references 002_migrate_note_videos",
        "CGO_ENABLED=0 go build ./... passes",
        "CGO_ENABLED=0 go vet ./... passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Canonicalise migration 001 â€” remove ALTER TABLE, add FK constraint",
      "description": "As a developer, I want migration 001 to be a clean canonical schema with no backward-compat hacks and with notes.video_id correctly referencing videos(id).",
      "acceptanceCriteria": [
        "Remove the backward-compat block from 001_create_videos_table.sql (lines 72-75): the comment and ALTER TABLE notes ADD COLUMN video_id INTEGER DEFAULT 0",
        "Update or remove the comment on line 3 that references note_videos and migration 002",
        "notes.video_id column declaration reads: video_id INTEGER DEFAULT 0 REFERENCES videos(id)",
        "No ALTER TABLE statements remain in 001_create_videos_table.sql",
        "All CREATE TABLE IF NOT EXISTS statements and indexes are otherwise unchanged",
        "CGO_ENABLED=0 go build ./... passes",
        "CGO_ENABLED=0 go vet ./... passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Delete orphaned insert_note_video.sql",
      "description": "As a developer, I want the dead insert_note_video.sql file removed because it inserts into the defunct note_videos table and is not embedded or used anywhere in Go code.",
      "acceptanceCriteria": [
        "db/sql/insert_note_video.sql is deleted",
        "Grep confirms no Go file embeds or references insert_note_video.sql",
        "CGO_ENABLED=0 go build ./... passes",
        "CGO_ENABLED=0 go vet ./... passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": ""
    }
  ]
}

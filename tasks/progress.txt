# Ralph Progress Log
# Branch: ralph/tui-layout-update
# Started: 2026-02-14

## Codebase Patterns
- Use `CGO_ENABLED=0` for all Go build/vet commands (modernc.org/sqlite requirement)
- Go binary at `/home/node/go/bin/go` — export PATH before commands
- RenderInfoBox in tui/components/controls.go (line ~84) — reuse for all containers
- RenderMiniPlayer in tui/components/controls.go (line ~260) — refactor to use RenderInfoBox
- StatusBarState in tui/components/statusbar.go — add VideoOpen bool field
- mpv connection state: m.client.IsConnected() in tui/tui.go
- updateStatusFromMpv at tui/tui.go line ~1546 — where to set VideoOpen
- StatsPanel in tui/components/statspanel.go — remove Summary, wrap sections in InfoBox
- renderColumn1/2 in tui/columns.go — add Summary box, wrap NotesList
- JoinColumns + ComputeColumnWidths in tui/layout/columns.go — remove borders

---

## 2026-02-14 - US-001
- Replaced RenderMiniPlayer's 3-line tab header and internal dividers with RenderInfoBox("Playback", contentLines, cardWidth)
- Content lines: status+step, time, overlay — all plain rows inside InfoBox
- Preserved centering logic, mute icon, and showWarning behavior
- Files changed: tui/components/controls.go
- **Learnings for future iterations:**
  - RenderInfoBox handles all border drawing — just pass content lines and width
  - cardWidth calculation (widest content + 4) still needed before calling RenderInfoBox
  - The minCardW check needs adjusting since RenderInfoBox uses ╭─ Title ─╮ (simpler overhead than 3-line tab)
---

## 2026-02-14 - US-002
- Added VideoOpen bool field to StatusBarState
- Set VideoOpen = true/false in updateStatusFromMpv based on m.client.IsConnected()
- Added "Video: Open/Closed" content line after overlay in RenderMiniPlayer
- Files changed: tui/components/statusbar.go, tui/components/controls.go, tui/tui.go
- **Learnings for future iterations:**
  - updateStatusFromMpv has an early return guard — set VideoOpen=false before the guard, true after
  - Adding a new content line to RenderMiniPlayer just needs appending to contentLines slice and adding width check
---

## 2026-02-14 - US-003
- Added Summary InfoBox to renderColumn1 between Playback and Selected Tag
- Removed "Live Stats" title, blank line, and Summary section from StatsPanel
- Files changed: tui/columns.go, tui/components/statspanel.go
- **Learnings for future iterations:**
  - Count items by iterating m.notesList.Items and checking item.Type == components.ItemTypeNote vs ItemTypeTackle
  - summaryHeaderStyle was kept in StatsPanel for Event Distribution and Tackle Stats headers
---

## 2026-02-14 - US-004
- Wrapped NotesList output in RenderInfoBox("Notes", notesLines, width)
- Reduced height by 2 and width by 2 for InfoBox borders
- Split NotesList output into []string lines for InfoBox contentLines
- Files changed: tui/columns.go
- **Learnings for future iterations:**
  - RenderInfoBox takes []string content lines — split NotesList string output on "\n"
  - Must reduce both height (-2) and width (-2) for InfoBox border overhead
---

## 2026-02-14 - US-005
- Wrapped Event Distribution bar graph and Tackle Stats table in separate RenderInfoBox containers
- Removed summaryHeaderStyle plain-text headers (InfoBox titles replace them)
- Used innerWidth (width-2) for bar graph and table column width calculations
- Joined boxes with blank line: eventBox + "\n\n" + tackleBox
- Files changed: tui/components/statspanel.go
- **Learnings for future iterations:**
  - When wrapping content in RenderInfoBox, adjust width calculations to use innerWidth = width - 2
  - RenderInfoBox title replaces the old summaryHeaderStyle headers
---

## 2026-02-14 - US-006
- Set borders = 0 in all ComputeColumnWidths code paths
- Removed borderStr (purple │) from JoinColumns, columns now concatenated flush
- Removed lipgloss and styles imports from columns.go (no longer needed)
- Files changed: tui/layout/columns.go
- **Learnings for future iterations:**
  - Setting borders=0 automatically gives col2 the extra width via the usable calculation
  - strings.Join(parts, "") concatenates columns flush
---

## 2026-02-14 - US-007
- Updated Column Rendering table: Col1 now shows "Playback status, summary counts, selected tag detail"
- Updated Col3 description: "Event distribution bar graph, tackle stats table"
- Updated JoinColumns description: columns joined flush with no separators
- Updated ComputeColumnWidths: noted borders = 0
- Added RenderMiniPlayer signature noting it uses RenderInfoBox style
- Updated StatsPanel description: each section wrapped in RenderInfoBox
- Added VideoOpen to StatusBarState fields
- Removed "column separators" from Purple colour usage
- Files changed: tui/TUI-ARCHITECTURE.md
---

